# make automatic deploying 'Postways' changes to AWS EC2 running instance

name: postways_changes_deploy_AWS

on:
  push:
    branches:
      - main
      
jobs:

  push_to_main:
    runs-on: ubuntu-latest
    steps:
      - name: git pull from remote repo
        env : 
          PRIVATE_KEY: ${{ secrets.AWS_PRIVATE_KEY }}
          HOSTNAME   : ${{ secrets.HOSTNAME }}
          USER_NAME  : ${{ secrets.USER_NAME }}
        
        run : |
          echo "$PRIVATE_KEY" > MyFirstKeyPair.pem && chmod 400 MyFirstKeyPair.pem
          ssh -o StrictHostKeyChecking=no -i MyFirstKeyPair.pem ${USER_NAME}@${HOSTNAME} '
            cd BlogPost/ && git pull origin main
          '
      
